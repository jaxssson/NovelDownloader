"use strict";var input=document.getElementById("input"),submit=document.getElementById("submit"),downloadContent=document.getElementById("download-content"),downloader=document.getElementById("downloader"),txtTitle=document.getElementById("txt-title"),messageContent=document.getElementById("message-content"),socket=void 0;function isUrlValid(){return/www.haxtxt.net\/files\/article\/\S+?.html?$/.test(input.value)}function connectSocket(){var t=null;(socket=io.connect("http://localhost:10010")).on("connect",function(){addMessage("webSocket connected"),submit.disabled="disabled"}),socket.on("disconnect",function(){addMessage("webSocket closed"),submit.disabled=""}),socket.on("stateChange",function(e){addMessage(e)}),socket.on("processChange",function(e){t=addProcess(e,t)}),socket.on("success",function(e){addSuccessMessage(e)}),socket.on("failure",function(e){addFailureMessage(e)}),socket.on("file",function(e){e&&addDownload(e)}),socket.emit("url",input.value)}function addMessage(e,t){var n=document.createElement("li");n.innerText=e,n.style.color=t||"#000000",messageContent.appendChild(n)}function addSuccessMessage(e){addMessage(e,"#0000ff")}function addFailureMessage(e){addMessage(e,"#ff0000")}function addProcess(e,t){return t||(t=document.createElement("li"),messageContent.appendChild(t)),t.innerText=e.msg,e.done?null:t}function addDownload(e){downloadContent.style.display="block",downloader.download=e,downloader.href="/txt/"+e+".txt",txtTitle.innerText=e}submit.addEventListener("click",function(){messageContent.innerHTML="",downloadContent.style.display="none",isUrlValid()?connectSocket():addMessage("url无效",2)});